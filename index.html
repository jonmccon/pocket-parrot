<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pocket Parrot - Mobile Sensor Platform</title>
    
    <!-- Local Tailwind CSS Configuration -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                        secondary: '#64748b'
                    }
                }
            }
        }
    </script>
    
    <!-- Fallback CSS for when CDN is blocked -->
    <link rel="stylesheet" href="fallback.css">
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" 
          crossorigin="anonymous" />
    
    <!-- TensorFlow.js -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.13.0/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd@2.2.2/dist/coco-ssd.min.js"></script>
    
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin="anonymous"></script>
    
    <style>
        /* Custom styles for map and camera */
        .map-container {
            height: 400px;
            width: 100%;
        }
        
        .camera-preview {
            max-width: 100%;
            height: auto;
        }
        
        .sensor-data {
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
        }
        
        /* Hide elements by default */
        .hidden {
            display: none !important;
        }
        
        /* Loading spinner */
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 2s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Mobile-first responsive design */
        @media (max-width: 768px) {
            /* Compact header on mobile */
            nav {
                padding: 0.5rem 1rem;
            }
            
            nav h1 {
                font-size: 1rem;
            }
            
            nav .nav-btn {
                padding: 0.25rem 0.5rem;
                font-size: 0.75rem;
            }
            
            /* Hide page title on mobile */
            .mobile-hide-title {
                display: none;
            }
            
            /* Ultra-compact main container */
            .container {
                padding: 0.25rem !important;
            }
            
            /* Ultra-compact card */
            .bg-gray-800.rounded-lg.shadow-lg {
                padding: 0.5rem !important;
                margin-bottom: 0 !important;
            }
            
            /* Ultra-compact sensor data */
            .sensor-data {
                font-size: 0.65rem;
                line-height: 1.1;
            }
            
            /* Two-column compact layout for mobile sensors */
            .mobile-sensor-grid {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 0.25rem;
            }
            
            /* Orientation takes full width to show large graph */
            .mobile-sensor-grid > div:nth-child(2) {
                grid-column: 1 / -1;
            }
            
            /* Compress sensor cards on mobile */
            .mobile-sensor-grid > div {
                padding: 0.3rem !important;
            }
            
            .mobile-sensor-grid h3 {
                font-size: 0.75rem;
                margin-bottom: 0.1rem !important;
            }
            
            /* Stack streaming controls on mobile */
            .mobile-controls {
                flex-direction: column;
                gap: 0.25rem;
                margin-bottom: 0.35rem !important;
            }
            
            /* Full-width streaming status on mobile */
            .mobile-streaming-status {
                order: -1;
                margin-bottom: 0.5rem;
            }
            
            /* Hide complex visual elements and single sample button on mobile */
            .mobile-hide {
                display: none !important;
            }
            
            /* Larger touch targets for mobile */
            .mobile-button {
                min-height: 40px;
                font-size: 0.8rem;
                padding: 0.4rem 0.8rem !important;
            }
            
            /* Show larger orientation visual on mobile */
            .mobile-orientation-large {
                display: flex !important;
                justify-content: center;
                align-items: center;
                margin-top: 0.15rem;
            }
            
            .mobile-orientation-large svg {
                width: 85px !important;
                height: 85px !important;
            }
            
            /* Compact status display */
            #statusDisplay {
                padding: 0.3rem !important;
                margin-bottom: 0.25rem !important;
            }
            
            #statusDisplay .text-sm {
                font-size: 0.6rem;
                line-height: 1.05;
            }
            
            /* Compact camera section */
            .mobile-camera-compact {
                padding: 0.3rem !important;
                margin-bottom: 0 !important;
            }
            
            .mobile-camera-compact h3 {
                font-size: 0.75rem;
                margin-bottom: 0.25rem !important;
            }
            
            .mobile-camera-compact .flex.flex-wrap {
                gap: 0.25rem !important;
                margin-bottom: 0 !important;
            }
            
            /* Single-line sensor display */
            .sensor-data > div {
                display: inline;
                margin-right: 0.4rem;
            }
            
            /* Reduce gaps in sensor grid cards */
            .mobile-sensor-grid .flex.gap-4 {
                gap: 0.5rem !important;
            }
        }
        
        /* Streaming indicator animation */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .streaming-pulse {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body class="dark bg-gray-900 text-gray-100 min-h-screen">
    <!-- Navigation Header -->
    <nav class="bg-gray-800 text-gray-100 p-4 shadow-lg border-b border-gray-700">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-xl font-bold">ü¶ú Pocket Parrot</h1>
            <div class="flex space-x-2">
                <button id="captureBtn" class="nav-btn bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm">
                    Capture
                </button>
                <button id="viewBtn" class="nav-btn bg-green-600 hover:bg-green-700 px-3 py-1 rounded text-sm">
                    View Data
                </button>
                <button id="settingsBtn" class="nav-btn bg-purple-600 hover:bg-purple-700 px-3 py-1 rounded text-sm">
                    Settings
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content Container -->
    <div class="container mx-auto p-4 max-w-4xl">
        
        <!-- Capture Page -->
        <div id="capturePage" class="page">
            <div class="bg-gray-800 rounded-lg shadow-lg p-6 mb-6 border border-gray-700">
                <h2 class="text-2xl font-bold mb-4 text-gray-100 mobile-hide-title">Sensor Capture</h2>
                
                <!-- Live Streaming Controls -->
                <div class="flex flex-wrap gap-3 mb-6 mobile-controls">
                    <button id="startLiveStreamBtn" class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg font-medium text-lg mobile-button w-full sm:w-auto">
                        üöÄ Start Live Stream
                    </button>
                    <button id="stopLiveStreamBtn" class="bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-lg font-medium text-lg mobile-button w-full sm:w-auto hidden">
                        ‚è∏Ô∏è Stop Streaming
                    </button>
                    <button id="captureSensorDataBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-medium mobile-button w-full sm:w-auto mobile-hide">
                        üìä Single Sample
                    </button>
                </div>

                <!-- Streaming Status -->
                <div id="streamingStatus" class="bg-gradient-to-r from-green-800 to-green-900 p-4 rounded-lg mb-4 border-2 border-green-600 hidden mobile-streaming-status mobile-hide">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-semibold text-gray-100 text-lg">üì° Live Streaming</h3>
                        <div class="flex items-center">
                            <div id="streamingIndicator" class="w-4 h-4 bg-green-400 rounded-full streaming-pulse mr-2"></div>
                            <span id="streamingRate" class="text-sm text-gray-200 font-medium">Every 5s</span>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div class="text-center">
                            <div class="text-gray-300">Samples Sent</div>
                            <div id="samplesSent" class="text-2xl font-bold text-blue-300">0</div>
                        </div>
                        <div class="text-center">
                            <div class="text-gray-300">Connection</div>
                            <div id="connectionStatus" class="text-2xl font-bold text-green-300">‚óè</div>
                        </div>
                    </div>
                </div>

                <!-- Status Display -->
                <div id="statusDisplay" class="bg-gray-700 p-3 rounded-lg mb-4 border border-gray-600">
                    <div class="text-sm text-gray-300">Status: <span id="statusText" class="font-medium text-gray-100">Ready</span></div>
                    <div class="text-sm text-gray-300">Records: <span id="recordCount" class="font-medium text-gray-100">0</span></div>
                    <div class="text-sm text-gray-300">Streaming: <span id="streamingStatusText" class="font-medium text-gray-100">Inactive</span></div>
                </div>

                <!-- Live Sensor Data -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 mobile-sensor-grid">
                    <!-- GPS Data -->
                    <div class="bg-blue-900 p-4 rounded-lg border border-blue-800">
                        <h3 class="font-semibold text-blue-200 mb-2">üìç GPS</h3>
                        <div id="gpsData" class="sensor-data text-sm text-gray-300">
                            <div>Lat: <span id="latitude">--</span></div>
                            <div>Lon: <span id="longitude">--</span></div>
                            <div class="mobile-hide">Altitude: <span id="altitude">--</span> m</div>
                            <div class="mobile-hide">Speed: <span id="speed">--</span> m/s</div>
                            <div>Accuracy: <span id="accuracy">--</span> m</div>
                        </div>
                    </div>

                    <!-- Orientation Data -->
                    <div class="bg-green-900 p-4 rounded-lg border border-green-800">
                        <h3 class="font-semibold text-green-200 mb-2">üß≠ Orientation</h3>
                        <div class="flex gap-4">
                            <!-- Numeric data -->
                            <div id="orientationData" class="sensor-data text-sm flex-1 text-gray-300">
                                <div>Alpha: <span id="alpha">--</span>¬∞</div>
                                <div>Beta: <span id="beta">--</span>¬∞</div>
                                <div>Gamma: <span id="gamma">--</span>¬∞</div>
                                <div>Compass: <span id="compass">--</span>¬∞</div>
                            </div>
                            <!-- Visual orientation indicator - hidden on mobile by default, shown large below -->
                            <div class="flex-shrink-0 mobile-hide">
                                <div class="text-xs text-gray-400 mb-1 text-center">Orientation</div>
                                <svg id="orientationVisual" width="80" height="80" viewBox="0 0 80 80" class="border border-gray-600 rounded bg-gray-800">
                                    <!-- Device representation -->
                                    <rect id="deviceRect" x="30" y="20" width="20" height="40" rx="3" fill="#4b5563" stroke="#374151" stroke-width="1"/>
                                    <!-- Compass needle -->
                                    <g id="compassNeedle">
                                        <line x1="40" y1="40" x2="40" y2="25" stroke="#ef4444" stroke-width="2" stroke-linecap="round"/>
                                        <circle cx="40" cy="40" r="2" fill="#ef4444"/>
                                    </g>
                                    <!-- Cardinal directions -->
                                    <text x="40" y="12" text-anchor="middle" font-size="8" fill="#9ca3af">N</text>
                                    <text x="68" y="44" text-anchor="middle" font-size="8" fill="#9ca3af">E</text>
                                    <text x="40" y="72" text-anchor="middle" font-size="8" fill="#9ca3af">S</text>
                                    <text x="12" y="44" text-anchor="middle" font-size="8" fill="#9ca3af">W</text>
                                </svg>
                            </div>
                        </div>
                        <!-- Large orientation visual for mobile -->
                        <div class="mobile-orientation-large" style="display: none;">
                            <svg id="orientationVisualMobile" width="85" height="85" viewBox="0 0 120 120" class="border border-gray-600 rounded bg-gray-800">
                                <!-- Device representation -->
                                <rect id="deviceRectMobile" x="45" y="30" width="30" height="60" rx="4" fill="#4b5563" stroke="#374151" stroke-width="2"/>
                                <!-- Compass needle -->
                                <g id="compassNeedleMobile">
                                    <line x1="60" y1="60" x2="60" y2="35" stroke="#ef4444" stroke-width="3" stroke-linecap="round"/>
                                    <circle cx="60" cy="60" r="3" fill="#ef4444"/>
                                </g>
                                <!-- Cardinal directions -->
                                <text x="60" y="18" text-anchor="middle" font-size="12" fill="#9ca3af" font-weight="bold">N</text>
                                <text x="102" y="66" text-anchor="middle" font-size="12" fill="#9ca3af" font-weight="bold">E</text>
                                <text x="60" y="108" text-anchor="middle" font-size="12" fill="#9ca3af" font-weight="bold">S</text>
                                <text x="18" y="66" text-anchor="middle" font-size="12" fill="#9ca3af" font-weight="bold">W</text>
                            </svg>
                        </div>
                    </div>

                    <!-- Motion Data -->
                    <div class="bg-yellow-900 p-4 rounded-lg border border-yellow-800">
                        <h3 class="font-semibold text-yellow-200 mb-2">üèÉ Motion</h3>
                        <div id="motionData" class="sensor-data text-sm text-gray-300">
                            <div>Accel X: <span id="accelX">--</span></div>
                            <div>Accel Y: <span id="accelY">--</span></div>
                            <div>Accel Z: <span id="accelZ">--</span></div>
                        </div>
                    </div>

                    <!-- Weather Data -->
                    <div class="bg-purple-900 p-4 rounded-lg border border-purple-800">
                        <h3 class="font-semibold text-purple-200 mb-2">üå§Ô∏è Weather</h3>
                        <div id="weatherData" class="sensor-data text-sm text-gray-300">
                            <div>Temp: <span id="temperature">--</span>¬∞C</div>
                            <div>Humidity: <span id="humidity">--</span>%</div>
                            <div class="mobile-hide">Wind: <span id="windSpeed">--</span> km/h</div>
                            <div class="mobile-hide">Conditions: <span id="conditions">--</span></div>
                        </div>
                        <div class="mt-2 pt-2 border-t border-purple-700 mobile-hide">
                            <div id="weatherStatus" class="text-xs text-gray-400">Waiting for location...</div>
                            <div id="weatherAccuracy" class="text-xs text-gray-400">No Data</div>
                        </div>
                    </div>
                </div>

                <!-- Camera Section -->
                <div class="bg-gray-700 p-4 rounded-lg mb-4 border border-gray-600 mobile-camera-compact">
                    <h3 class="font-semibold text-gray-100 mb-3">üì∑ Camera</h3>
                    <div class="flex flex-wrap gap-3 mb-3">
                        <button id="startCameraBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm mobile-button w-full sm:w-auto">
                            üì∑ Start Camera
                        </button>
                        <button id="takePhotoBtn" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded text-sm mobile-button w-full sm:w-auto hidden">
                            ‚úÖ Take Photo
                        </button>
                        <button id="cancelCameraBtn" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded text-sm mobile-button w-full sm:w-auto hidden">
                            ‚ùå Cancel
                        </button>
                    </div>
                    <video id="cameraPreview" class="camera-preview hidden rounded-lg border-2 border-gray-600 w-full"></video>
                    <canvas id="photoCanvas" class="hidden"></canvas>
                    
                    <!-- Captured Photo Display -->
                    <div id="capturedPhotoDisplay" class="mt-3 hidden">
                        <h4 class="font-semibold text-gray-200 mb-2">üì∏ Captured Photo</h4>
                        <img id="capturedPhotoImage" class="max-w-full h-auto rounded-lg border-2 border-gray-600" alt="Captured photo">
                        <p class="text-xs text-gray-400 mt-2">Photo will be included in next data submission</p>
                    </div>
                    
                    <!-- Enhanced Detection Results -->
                    <div id="detectionResults" class="mt-3 hidden">
                        <h4 class="font-semibold text-gray-200 mb-2">üîç Objects Detected</h4>
                        <div id="objectsContainer" class="flex flex-wrap gap-2"></div>
                    </div>
                </div>

                <!-- Audio Section - Hidden for events -->
                <div class="bg-gray-700 p-4 rounded-lg border border-gray-600" style="display: none;" id="audioSection">
                    <h3 class="font-semibold text-gray-100 mb-3">üé§ Audio Recording</h3>
                    <div class="flex flex-wrap gap-3 mb-3">
                        <button id="startRecordingBtn" class="bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded text-sm">
                            Start Recording
                        </button>
                        <button id="stopRecordingBtn" class="bg-gray-500 hover:bg-gray-600 text-white px-3 py-2 rounded text-sm hidden">
                            Stop Recording
                        </button>
                    </div>
                    <div id="recordingStatus" class="text-sm text-gray-400"></div>
                    
                    <!-- Audio Waveform Visualization -->
                    <div id="audioWaveform" class="mt-3 hidden">
                        <h4 class="font-semibold text-gray-200 mb-2">üéµ Audio Waveform</h4>
                        <canvas id="waveformCanvas" width="400" height="100" class="w-full border border-gray-600 rounded bg-gray-800"></canvas>
                    </div>
                    
                    <audio id="audioPlayback" class="mt-2 hidden" controls></audio>
                </div>
            </div>
        </div>

        <!-- Data Viewer Page -->
        <div id="viewerPage" class="page hidden">
            <div class="bg-gray-800 rounded-lg shadow-lg p-6 mb-6 border border-gray-700">
                <h2 class="text-2xl font-bold mb-4 text-gray-100">Data Viewer</h2>
                
                <!-- Filters and Controls -->
                <div class="flex flex-wrap gap-3 mb-4">
                    <input type="date" id="dateFilter" class="border border-gray-600 bg-gray-700 text-gray-200 rounded px-3 py-2 text-sm">
                    <select id="objectFilter" class="border border-gray-600 bg-gray-700 text-gray-200 rounded px-3 py-2 text-sm">
                        <option value="">All Objects</option>
                    </select>
                    <button id="clearFiltersBtn" class="bg-gray-600 hover:bg-gray-700 text-white px-3 py-2 rounded text-sm">
                        Clear Filters
                    </button>
                    <div class="ml-auto flex gap-2">
                        <button id="exportBtn" class="bg-purple-600 hover:bg-purple-700 text-white px-3 py-2 rounded text-sm">
                            Export Data
                        </button>
                        <button id="deleteAllBtn" class="bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded text-sm">
                            Delete All
                        </button>
                    </div>
                </div>

                <!-- Map Container -->
                <div id="mapContainer" class="map-container rounded-lg border-2 border-gray-600 mb-4"></div>

                <!-- Data Accordion -->
                <div id="dataAccordion" class="space-y-3">
                    <!-- Data samples will be inserted here as accordion items -->
                </div>
            </div>
        </div>

        <!-- Settings Page -->
        <div id="settingsPage" class="page hidden">
            <div class="bg-gray-800 rounded-lg shadow-lg p-6 mb-6 border border-gray-700">
                <h2 class="text-2xl font-bold mb-4 text-gray-100">‚öôÔ∏è Data Access Settings</h2>
                
                <!-- JavaScript API Documentation -->
                <div class="mb-6">
                    <h3 class="text-xl font-semibold mb-2 text-gray-200">üì° JavaScript API Access</h3>
                    <p class="text-sm text-gray-400 mb-3">
                        For same-origin integrations, use the JavaScript API to access data programmatically.
                    </p>
                    <div class="bg-gray-900 border border-gray-700 rounded p-4 text-sm text-gray-300 font-mono">
                        <div class="mb-2">// Access the global API instance</div>
                        <div class="mb-2">const api = window.pocketParrotAPI;</div>
                        <div class="mb-2">&nbsp;</div>
                        <div class="mb-2">// Get all data</div>
                        <div class="mb-2">const data = await api.getAllData();</div>
                        <div class="mb-2">&nbsp;</div>
                        <div class="mb-2">// Subscribe to real-time updates</div>
                        <div class="mb-2">const unsubscribe = api.subscribe((dataPoint) => {</div>
                        <div class="mb-2">&nbsp;&nbsp;console.log('New data:', dataPoint);</div>
                        <div class="mb-2">});</div>
                    </div>
                </div>

                <!-- WebSocket Configuration -->
                <div class="mb-6">
                    <h3 class="text-xl font-semibold mb-2 text-gray-200">üîå WebSocket Push Configuration</h3>
                    <p class="text-sm text-gray-400 mb-3">
                        Configure an external WebSocket endpoint to receive real-time data as it's captured.
                    </p>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2 text-gray-300">WebSocket Endpoint</label>
                        <input 
                            type="text" 
                            id="wsEndpoint" 
                            placeholder="ws://localhost:8080/data"
                            class="w-full border border-gray-600 bg-gray-700 text-gray-200 rounded px-3 py-2 text-sm"
                        />
                        <p class="text-xs text-gray-500 mt-1">Example: ws://your-server.com:8080/pocket-parrot</p>
                    </div>

                    <div class="flex gap-3 mb-4">
                        <button id="saveWsConfigBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm">
                            üíæ Save Configuration
                        </button>
                        <button id="enableWsBtn" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded text-sm">
                            ‚úÖ Enable WebSocket
                        </button>
                        <button id="disableWsBtn" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded text-sm hidden">
                            üîå Disable WebSocket
                        </button>
                        <button id="testWsBtn" class="bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded text-sm">
                            üß™ Test Connection
                        </button>
                    </div>

                    <div id="wsStatus" class="hidden bg-gray-900 border border-gray-700 rounded p-3 text-sm">
                        <div class="font-semibold mb-1 text-gray-200">Connection Status</div>
                        <div id="wsStatusText" class="text-gray-400">Not configured</div>
                    </div>
                </div>

                <!-- Streaming Configuration -->
                <div class="mb-6">
                    <h3 class="text-xl font-semibold mb-2 text-gray-200">üì° Live Streaming Configuration</h3>
                    <p class="text-sm text-gray-400 mb-3">
                        Configure how often data is captured and what types of data to include when streaming.
                    </p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-300">Capture Interval</label>
                            <select id="captureInterval" class="w-full border border-gray-600 bg-gray-700 text-gray-200 rounded px-3 py-2 text-sm">
                                <option value="1000">1 second (High Frequency)</option>
                                <option value="2000">2 seconds</option>
                                <option value="5000" selected>5 seconds (Default)</option>
                                <option value="10000">10 seconds</option>
                                <option value="30000">30 seconds</option>
                                <option value="60000">1 minute (Low Frequency)</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-300">Data Mode</label>
                            <select id="dataMode" class="w-full border border-gray-600 bg-gray-700 text-gray-200 rounded px-3 py-2 text-sm">
                                <option value="full">Full Data (GPS + Sensors + Weather)</option>
                                <option value="sensors">Sensors Only (GPS + Orientation + Motion)</option>
                                <option value="gps" selected>GPS Only (Lightweight)</option>
                            </select>
                        </div>
                    </div>

                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2 text-gray-300">Data Options</label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="checkbox" id="includeWeather" class="mr-2" checked>
                                <span class="text-gray-300">Include weather data (1x per minute)</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="includeMedia" class="mr-2">
                                <span class="text-gray-300">Include photos/audio (increases data usage)</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="highAccuracyGPS" class="mr-2" checked>
                                <span class="text-gray-300">High accuracy GPS (uses more battery)</span>
                            </label>
                        </div>
                    </div>

                    <div class="flex gap-3 mb-4">
                        <button id="saveStreamingConfigBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm">
                            üíæ Save Streaming Config
                        </button>
                        <button id="resetStreamingConfigBtn" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded text-sm">
                            üîÑ Reset to Default
                        </button>
                    </div>

                    <div class="bg-gray-900 border border-gray-700 rounded p-3 text-xs text-gray-400">
                        <div class="font-semibold mb-1">Data Usage Estimates (per hour):</div>
                        <div id="dataUsageEstimate">
                            <div>GPS Only (5s): ~300KB/hour</div>
                            <div>Full Sensors (5s): ~600KB/hour</div>
                            <div>With Photos: +500KB-2MB per capture</div>
                        </div>
                    </div>
                </div>

                <!-- API Status -->
                <div class="mb-6">
                    <h3 class="text-xl font-semibold mb-2 text-gray-200">üìä API Status</h3>
                    <div class="bg-gray-900 border border-gray-700 rounded p-4">
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <div class="text-gray-400">Active Subscribers</div>
                                <div id="apiSubscribers" class="text-2xl font-bold text-blue-400">0</div>
                            </div>
                            <div>
                                <div class="text-gray-400">WebSocket Status</div>
                                <div id="apiWsStatus" class="text-2xl font-bold text-gray-400">Disabled</div>
                            </div>
                            <div>
                                <div class="text-gray-400">Total Records</div>
                                <div id="apiRecordCount" class="text-2xl font-bold text-green-400">0</div>
                            </div>
                            <div>
                                <div class="text-gray-400">WebSocket Connections</div>
                                <div id="apiWsConnections" class="text-2xl font-bold text-purple-400">0</div>
                            </div>
                        </div>
                        <button id="refreshStatusBtn" class="mt-4 bg-gray-700 hover:bg-gray-600 text-white px-3 py-1 rounded text-sm">
                            üîÑ Refresh Status
                        </button>
                    </div>
                </div>

                <!-- Export API -->
                <div class="mb-6">
                    <h3 class="text-xl font-semibold mb-2 text-gray-200">üì§ Export API</h3>
                    <p class="text-sm text-gray-400 mb-3">
                        Export data programmatically with filtering options.
                    </p>
                    <div class="bg-gray-900 border border-gray-700 rounded p-4 text-sm text-gray-300 font-mono">
                        <div class="mb-2">// Export with filters</div>
                        <div class="mb-2">const json = await api.exportJSON({</div>
                        <div class="mb-2">&nbsp;&nbsp;startDate: '2024-01-01',</div>
                        <div class="mb-2">&nbsp;&nbsp;endDate: '2024-12-31',</div>
                        <div class="mb-2">&nbsp;&nbsp;hasGPS: true,</div>
                        <div class="mb-2">&nbsp;&nbsp;includeMedia: false,</div>
                        <div class="mb-2">&nbsp;&nbsp;limit: 100</div>
                        <div class="mb-2">});</div>
                    </div>
                </div>

                <!-- Documentation Link -->
                <div class="bg-blue-900 border border-blue-800 rounded p-4">
                    <h3 class="text-lg font-semibold mb-2 text-blue-200">üìö Documentation</h3>
                    <p class="text-sm text-blue-300 mb-2">
                        Full API documentation is available in the README.md file. See the "Data Access API" section for complete details on:
                    </p>
                    <ul class="list-disc list-inside text-sm text-blue-300 space-y-1">
                        <li>JavaScript API methods and examples</li>
                        <li>WebSocket message format and protocol</li>
                        <li>Query options and filtering</li>
                        <li>Authentication and security considerations</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Loading Overlay -->
        <div id="loadingOverlay" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center hidden z-50">
            <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                <div class="spinner"></div>
                <div class="text-center mt-4 text-gray-200">Loading...</div>
            </div>
        </div>
    </div>

    <!-- Configuration Script -->
    <script src="config.js"></script>
    
    <!-- Data Access API Script -->
    <script src="data-api.js"></script>
    
    <!-- Main Application Script -->
    <script src="app.js"></script>
</body>
</html>